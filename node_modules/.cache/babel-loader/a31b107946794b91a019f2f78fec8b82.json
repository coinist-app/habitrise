{"ast":null,"code":"import _defineProperty from\"/Users/sampath/Documents/code/me/stint-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/sampath/Documents/code/me/stint-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sampath/Documents/code/me/stint-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sampath/Documents/code/me/stint-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectDestructuringEmpty from\"/Users/sampath/Documents/code/me/stint-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty\";import React from\"react\";import{useState,useEffect,useRef}from\"react\";import Editor,{useMonaco}from\"@monaco-editor/react\";import{useSpeechSynthesis}from'react-speech-kit';import CONSTANTS from\"../../../constants\";import\"./engine.module.css\";import Timer from'../../core/timer';var AssessmentEngine=function AssessmentEngine(_ref){_objectDestructuringEmpty(_ref);var LANG_ID_JAVA=sessionStorage.getItem('editorLangId');var speechQuestionTitle=useRef(null);var monaco=useMonaco();var _useState=useState({}),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),lang=_useState4[0],setLang=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),questionTitle=_useState6[0],setQuestionTitle=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),questionDescription=_useState8[0],setQuestionDescription=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),langId=_useState10[0],setLangId=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),questionId=_useState12[0],setQuestionId=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),userInput=_useState14[0],setUserInput=_useState14[1];var _useState15=useState(\"Running...\"),_useState16=_slicedToArray(_useState15,2),output=_useState16[0],setOutput=_useState16[1];var _useState17=useState(sessionStorage.getItem('defaultCode')),_useState18=_slicedToArray(_useState17,2),defaultCode=_useState18[0],setDefaultCode=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),showOutput=_useState20[0],setShowOutput=_useState20[1];var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),timeRemaining=_useState22[0],setTimeRemaining=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),lastOutput=_useState24[0],setLastOutput=_useState24[1];var _useState25=useState(\"\"),_useState26=_slicedToArray(_useState25,2),resultCriteria=_useState26[0],setResultCriteria=_useState26[1];var _useState27=useState(0),_useState28=_slicedToArray(_useState27,2),syntacticalErrors=_useState28[0],setSyntacticalErrors=_useState28[1];var _useState29=useState(0),_useState30=_slicedToArray(_useState29,2),attemptedQuestionId=_useState30[0],setAttemptedQuestionId=_useState30[1];var _useState31=useState(false),_useState32=_slicedToArray(_useState31,2),isLastQuestion=_useState32[0],setIsLastQuestion=_useState32[1];var _useState33=useState(false),_useState34=_slicedToArray(_useState33,2),isLoading=_useState34[0],setIsLoading=_useState34[1];var _useState35=useState(false),_useState36=_slicedToArray(_useState35,2),isVoiceActive=_useState36[0],setIsVoiceActive=_useState36[1];var _useState37=useState(false),_useState38=_slicedToArray(_useState37,2),isShouldExplain=_useState38[0],setIsShouldExplain=_useState38[1];var _useState39=useState(\"Explain your approach\"),_useState40=_slicedToArray(_useState39,2),explainLabel=_useState40[0],setExplainLabel=_useState40[1];var prompt_run_error='0d79dc22-de64-4f90-86da-3cd5a297fe5c';var prompt_explain='5ce4a72e-9736-46f2-9ed3-1e25c338ac78';var prompt_run_success='a8e8fb65-f298-4012-9b42-d4b165b8b197';var prompt_code='a27e8bea-185a-4598-ae9d-9ce1412a2bcd';var onSpeechEnd=function onSpeechEnd(){console.log('on end');setIsVoiceActive(false);};var _useSpeechSynthesis=useSpeechSynthesis({onEnd:onSpeechEnd}),speak=_useSpeechSynthesis.speak,voices=_useSpeechSynthesis.voices;var handleEditorChange=function handleEditorChange(value,event){setInput(value);localStorage.setItem('input',value);setShowOutput(false);};var invokeAPI=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,jsonResponse,message,jsonGetSolution,url,getSolution,_output,error,compilation_error,errCount;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setOutput('Creating Submission ...');_context.next=3;return fetch(\"https://judge0-ce.p.rapidapi.com/submissions\",{method:\"POST\",headers:{\"x-rapidapi-host\":\"judge0-ce.p.rapidapi.com\",\"x-rapidapi-key\":\"a1504d0aebmsha2c15d90ecffa8dp117081jsn36e10aaf0ea7\",// Get yours for free at https://rapidapi.com/judge0-official/api/judge0-ce/\n\"content-type\":\"application/json\",accept:\"application/json\"},body:JSON.stringify({source_code:input,stdin:null,language_id:langId})});case 3:response=_context.sent;setOutput(\"Submission Created ...\\n\");_context.next=7;return response.json();case 7:jsonResponse=_context.sent;if(response.ok){_context.next=11;break;}message=\"An error has occured: \".concat(response.status);throw new Error(message);case 11:jsonGetSolution={status:{description:\"Queue\"},stderr:null,compile_output:null};case 12:if(!(jsonGetSolution.status.description!==\"Accepted\"&&jsonGetSolution.stderr==null&&jsonGetSolution.compile_output==null)){_context.next=24;break;}setOutput(\"Creating Submission ... \\nSubmission Created ...\\nChecking Submission Status\\nstatus : \".concat(jsonGetSolution.status.description));if(!jsonResponse.token){_context.next=22;break;}url=\"https://judge0-ce.p.rapidapi.com/submissions/\".concat(jsonResponse.token,\"?base64_encoded=true\");_context.next=18;return fetch(url,{method:\"GET\",headers:{\"x-rapidapi-host\":\"judge0-ce.p.rapidapi.com\",\"x-rapidapi-key\":\"a1504d0aebmsha2c15d90ecffa8dp117081jsn36e10aaf0ea7\",// Get yours for free at https://rapidapi.com/judge0-official/api/judge0-ce/\n\"content-type\":\"application/json\"}});case 18:getSolution=_context.sent;_context.next=21;return getSolution.json();case 21:jsonGetSolution=_context.sent;case 22:_context.next=12;break;case 24:if(jsonGetSolution.stdout){_output=atob(jsonGetSolution.stdout);console.log('--output--',_output);setLastOutput(_output);setOutput(\"Results :\\n\".concat(_output,\"\\nExecution Time : \").concat(jsonGetSolution.time,\" Secs\\nMemory used : \").concat(jsonGetSolution.memory,\" bytes\"));sayExecutionSuccess();}else if(jsonGetSolution.stderr){error=atob(jsonGetSolution.stderr);setOutput(\"\\n Error :\".concat(error));}else{compilation_error=atob(jsonGetSolution.compile_output);errCount=syntacticalErrors+1;setSyntacticalErrors(errCount);console.log('syntacticalError',syntacticalErrors);setOutput(\"\\n Error :\".concat(compilation_error));sayCompilationFailure();}case 25:case\"end\":return _context.stop();}}},_callee);}));return function invokeAPI(){return _ref2.apply(this,arguments);};}();var run=function run(e){setShowOutput(true);/* window.addEventListener('unhandledrejection', event => { console.log('E: ',event); });\r\n  onunhandledrejection = event => {\r\n    alert('There was an error submitting your code. Pls check your syntax & try again.')\r\n    console.log('invoke API '); //window.location.reload();\r\n  }; */invokeAPI();};var submit=function submit(e){setIsLoading(true);var rawResponse=fetch(CONSTANTS.ENDPOINT.DIRECTUSAUTH,{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({\"email\":\"stint.assess@gmail.com\",\"password\":\"dstintapp1\"})}).then(function(res){var res=res.json();res.then(function(r){console.log('Data: ',r.data);console.log('AccessToken: ',r.data.access_token);var accessToken=r.data.access_token;createSessionRecording(accessToken);});});};var createSessionRecording=function createSessionRecording(accessToken){var recording=JSON.stringify(JSON.parse(localStorage.getItem('recording')).events);recording=recording.replaceAll(\"'\",\"&quot\");var rawResponse=fetch(CONSTANTS.ENDPOINT.POSTSESSIONRECORDING,{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({\"questionId\":questionId,\"sessionId\":parseInt(sessionStorage.getItem('assessment_session_id'),10),\"events\":recording})}).then(function(res){var res=res.json();res.then(function(r){console.log('session recording submitted');captureResults(accessToken);});});};var captureResults=function captureResults(accessToken){var solutionCorrectnessValue=0;var timeTakenMin=0;var numSyntacticalErrors=0;var minRem=document.getElementById('timeRem').innerHTML.replaceAll(' ','').split(':')[1];var secRem=document.getElementById('timeRem').innerHTML.replaceAll(' ','').replaceAll('s','').split(':')[2];var questionTimeLimitSecs=timeRemaining;var secondsRemaining=parseInt(minRem,10)*60+parseInt(secRem,10);console.log('--timeLimit--',questionTimeLimitSecs);console.log('--secondsElapsed--',secondsRemaining);timeTakenMin=(questionTimeLimitSecs-secondsRemaining)/60;console.log('--timeTakenMin--',timeTakenMin);if(lastOutput!=\"\"&&lastOutput.indexOf(resultCriteria)>=0){solutionCorrectnessValue=100;}createEvaluation(accessToken,\"solution_correctness\",solutionCorrectnessValue);createEvaluation(accessToken,\"time_taken_mins\",timeTakenMin);createEvaluation(accessToken,\"num_syntactical_errors\",syntacticalErrors);sessionStorage.setItem(\"attemptedQuestionIds\",sessionStorage.getItem('attemptedQuestionIds')+attemptedQuestionId+',');loadNextQuestion(solutionCorrectnessValue,timeTakenMin,syntacticalErrors);};var loadNextQuestion=function loadNextQuestion(solutionCorrectnessValue,timeTakenMin,syntacticalErrors){var progressDifficultyLevel=false;var currentDifficultyLevel=sessionStorage.getItem(\"difficultyLevel\");var nextDifficultyLevel=currentDifficultyLevel;//completed in half the time\nif(timeTakenMin*60<timeRemaining/2&&syntacticalErrors<30){progressDifficultyLevel=true;}if(progressDifficultyLevel){if(currentDifficultyLevel=='Beginner'){nextDifficultyLevel=\"Intermediate\";}else if(currentDifficultyLevel=='Intermediate'){nextDifficultyLevel=\"Advanced\";}sessionStorage.setItem(\"difficultyLevel\",nextDifficultyLevel);console.log('Difficulty level progressed!');}if(isLastQuestion){window.location.href='/assessment/done';}else{window.location.reload();}};var createEvaluation=function createEvaluation(accessToken,metric,value){var rawResponse=fetch(CONSTANTS.ENDPOINT.POSTEVALUATION+accessToken,{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({\"question_id\":questionId,\"assessment_session_id\":parseInt(sessionStorage.getItem('assessment_session_id'),10),\"metric\":metric,\"value\":value})}).then(function(res){var res=res.json();res.then(function(r){console.log('Data: ',r.data);});});};var getTimeLimitInMilliSecs=function getTimeLimitInMilliSecs(timeStr){timeStr=timeStr.replace(' min','');var timeInMins=parseInt(timeStr,10);var timeInMilliSecs=timeInMins*60*1000;return timeInMilliSecs;};var checkIsLastQuestion=function checkIsLastQuestion(timeLimit){var timeLimitInMilliSecs=getTimeLimitInMilliSecs(timeLimit);var timeLimitInSecs=timeLimitInMilliSecs/1000;var timeLimitInMin=timeLimitInSecs/60;var activeQuestionDuration=timeLimitInMin;var totalDuration=parseInt(sessionStorage.getItem('totalDuration'),10);if(sessionStorage.getItem('activeQuestionDuration')!=null&&sessionStorage.getItem('activeQuestionDuration')!=\"\"){activeQuestionDuration=activeQuestionDuration+parseInt(sessionStorage.getItem('activeQuestionDuration'),10);}sessionStorage.setItem('activeQuestionDuration',activeQuestionDuration);// make current question as last question if time remaining < 10 min\nif(totalDuration-activeQuestionDuration<10){setIsLastQuestion(true);}};var startQuestionTimer=function startQuestionTimer(timeLimit){var timeLimitInMilliSecs=getTimeLimitInMilliSecs(timeLimit);var timeLimitInSecs=timeLimitInMilliSecs/1000;console.log('::timer::');setTimeRemaining(timeLimitInSecs);console.log('timeInMilliSecs: ',timeLimitInMilliSecs);setTimeout(function(){console.log('load next question');},timeLimitInMilliSecs);};var getQuestion=function getQuestion(accessToken,skillId,competencyId,difficultyLevel){console.log('calling getQuestion...');var rawResponse=fetch(CONSTANTS.ENDPOINT.GETQUESTION+accessToken+'&filter={ \"difficulty_level\": { \"_eq\": \"'+difficultyLevel+'\" }, \"skill_id\": { \"_eq\": '+skillId+' }, \"competency\": { \"_eq\": '+competencyId+' }}').then(function(res){var res=res.json();res.then(function(r){var questionIndex=0;var question=r.data;console.log('--question[questionIndex].id--',questionIndex);console.log('--question[]--',question.length);while(sessionStorage.getItem(\"attemptedQuestionIds\")==null||sessionStorage.getItem(\"attemptedQuestionIds\")!=\"\"&&question.length>questionIndex&&sessionStorage.getItem(\"attemptedQuestionIds\").indexOf(question[questionIndex].id+',')==-1){console.log('--questionIndex',questionIndex);var title=question[questionIndex].title;var description=question[questionIndex].description;var codeSnippet=question[questionIndex].code_snippet;var timeLimit=question[questionIndex].time_limit;var questionSpeechFileId=question[questionIndex].speech;setQuestionId(question[questionIndex].id);console.log('codeSnippet: ',codeSnippet);console.log('timeLimit',timeLimit);startQuestionTimer(timeLimit);checkIsLastQuestion(timeLimit);setInput(codeSnippet);setQuestionTitle(title);setQuestionDescription(description);setResultCriteria(question[questionIndex].result_criteria);setAttemptedQuestionId(question[questionIndex].id);promptQuestion(accessToken,questionSpeechFileId);questionIndex++;break;}});});};var getQuestionToken=function getQuestionToken(){var rawResponse=fetch(CONSTANTS.ENDPOINT.DIRECTUSAUTH,{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({\"email\":\"stint.assess@gmail.com\",\"password\":\"dstintapp1\"})}).then(function(res){var res=res.json();res.then(function(r){console.log('Data: ',r.data);console.log('AccessToken1: ',r.data.access_token);var accessToken=r.data.access_token;var difficultyLevel=sessionStorage.getItem(\"difficultyLevel\");//read from session storage\nvar skillId=sessionStorage.getItem(\"primarySkill\");//read from session storage\nvar competencyId=sessionStorage.getItem(\"competencyId\");//read from session storage\ngetQuestion(accessToken,skillId,competencyId,difficultyLevel);});});};var events=[];var startSessionRecord=function startSessionRecord(){if(typeof window.rrweb!=\"undefined\"){var save=function save(){var body=JSON.stringify({events:events});localStorage.setItem('recording',body);console.log('--events--',body);/* new window.rrwebPlayer({\r\n          target: document.getElementById('container'), // customizable root element\r\n          props: {\r\n            events\r\n          },\r\n        }); */};window.rrweb.record({emit:function emit(event){// push event into the events array\nevents.push(event);}});setInterval(save,15*1000);}};var promptQuestion=function promptQuestion(accessToken,questionSpeechFileId){var audioTune=new Audio(CONSTANTS.ENDPOINT.GETSPEECHFILE.replace('<asset-id>',questionSpeechFileId)+accessToken);audioTune.load();audioTune.play();setTimeout(function(){setIsVoiceActive(true);},500);setTimeout(function(){setIsVoiceActive(false);promptExplain(accessToken);setTimeout(function(){setIsShouldExplain(true);},10000);},11000);};var promptExplain=function promptExplain(accessToken){var audioTune=new Audio(CONSTANTS.ENDPOINT.GETSPEECHFILE.replace('<asset-id>',prompt_explain)+accessToken);audioTune.load();audioTune.play();setTimeout(function(){setIsVoiceActive(true);},1500);setTimeout(function(){setIsVoiceActive(false);},14000);};var promptToCode=function promptToCode(){var rawResponse=fetch(CONSTANTS.ENDPOINT.DIRECTUSAUTH,{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({\"email\":\"stint.assess@gmail.com\",\"password\":\"dstintapp1\"})}).then(function(res){var res=res.json();res.then(function(r){var accessToken=r.data.access_token;var audioTune=new Audio(CONSTANTS.ENDPOINT.GETSPEECHFILE.replace('<asset-id>',prompt_code)+accessToken);audioTune.load();audioTune.play();setTimeout(function(){setIsVoiceActive(true);},1500);setTimeout(function(){setIsVoiceActive(false);},6000);});});};var sayExecutionSuccess=function sayExecutionSuccess(){//speak({ text: \"Great! Your code executed successfully.\", voice: voices[0], rate: 1, pitch: 1.7 });\nvar rawResponse=fetch(CONSTANTS.ENDPOINT.DIRECTUSAUTH,{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({\"email\":\"stint.assess@gmail.com\",\"password\":\"dstintapp1\"})}).then(function(res){var res=res.json();res.then(function(r){var accessToken=r.data.access_token;var audioTune=new Audio(CONSTANTS.ENDPOINT.GETSPEECHFILE.replace('<asset-id>',prompt_run_success)+accessToken);audioTune.load();audioTune.play();setTimeout(function(){setIsVoiceActive(true);},700);setTimeout(function(){setIsVoiceActive(false);},4000);});});};var sayCompilationFailure=function sayCompilationFailure(){//speak({ text: \"There-are some errors. Please-check your code and try again.\", voice: voices[0], rate: 1.1, pitch: 1.9 });\nvar rawResponse=fetch(CONSTANTS.ENDPOINT.DIRECTUSAUTH,{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({\"email\":\"stint.assess@gmail.com\",\"password\":\"dstintapp1\"})}).then(function(res){var res=res.json();res.then(function(r){var accessToken=r.data.access_token;var audioTune=new Audio(CONSTANTS.ENDPOINT.GETSPEECHFILE.replace('<asset-id>',prompt_run_error)+accessToken);audioTune.load();audioTune.play();setTimeout(function(){setIsVoiceActive(true);},700);setTimeout(function(){setIsVoiceActive(false);},4000);});});};var onExplainClick=function onExplainClick(){if(explainLabel=='Explain your approach'||explainLabel=='Explain again'){setExplainLabel(\"Listening... click to end recording\");}else{setExplainLabel(\"Explain again\");promptToCode();}};var startSpeech=function startSpeech(){speak({text:questionTitle,voice:voices[0],rate:1,pitch:1.7});setIsVoiceActive(true);setTimeout(function(){speak({text:\"Use \"+lang+\" to write your code\",voice:voices[0],rate:1,pitch:1.7});setIsVoiceActive(true);/* setTimeout(function() {\r\n            speak({ text: \"You can think through an approach and once you're ready you can explain. This will be recorded and used during evaluation.\", voice: voices[0], rate: 1, pitch: 1.7 });\r\n            setIsVoiceActive(true);\r\n            setTimeout(function() {\r\n                        speak({ text: \"Please go ahead once you're-ready.\", voice: voices[0], rate: 1, pitch: 1.7 });\r\n                        setIsVoiceActive(true);\r\n                    }, 1500);\r\n        }, 1500); */},1500);};var startVoiceBot=function startVoiceBot(){var SW9=new window.SiriWave({style:\"ios9\",container:document.getElementById(\"engine_container-9__1Cs0M\"),autostart:true});//ToDo: Uncomment to use speech synthesis API than FreeTTS\n//setTimeout(\"document.getElementById('speechQuestionTitle').click()\",2000);\n//https://freetts.com/Home/PlayAudio?Language=en-IN&Voice=en-IN-Standard-C&TextMessage=Find%20the%20frequency%20of%20each%20number%20in%20the%20given%20arraylist.%20%3Cbreak%20time%3D%221s%22%20%2F%3E%20Print%20output%20to%20console%20in%20the%20format%20given.%20%3Cbreak%20time%3D%221.5s%22%20%2F%3EUse%20Java%20to%20write%20your%20code.&type=0\n/* const rawResponse = fetch('https://freetts.com/Home/PlayAudio?Language=en-IN&Voice=en-IN-Standard-C&TextMessage=Find%20the%20frequency%20of%20each%20number%20in%20the%20given%20arraylist.%20%3Cbreak%20time%3D%221s%22%20%2F%3E%20Print%20output%20to%20console%20in%20the%20format%20given.%20%3Cbreak%20time%3D%221.5s%22%20%2F%3EUse%20Java%20to%20write%20your%20code.&type=0',\r\n    headers: {\r\n        'mode':'cors'\r\n      }).then((res)=>{\r\n      var res = res.json();\r\n        res.then(function(r) {\r\n          var speechURL = r.id;\r\n          console.log('Speech Response: ', r);\r\n          console.log('Speech Data: ', r.data);\r\n          console.log('Speech URL: ', speechURL);\r\n          //setSpeechURL(speechURL);\r\n        });\r\n      }); */};useEffect(function(){window.showVideo=true;setLang(sessionStorage.getItem('editorLangName'));setLangId(LANG_ID_JAVA);localStorage.setItem('language_Id',LANG_ID_JAVA);if(localStorage.getItem('input')!=null){console.log('localStorage.getItem(input): ',localStorage.getItem('input'));setDefaultCode(localStorage.getItem('input'));setInput(localStorage.getItem('input'));}getQuestionToken();startSessionRecord();startVoiceBot();//setOutput(\"Click the 'Save & Run' button to view your program's output.\");\nif(monaco){console.log(\"here is the monaco instance:\",monaco);}},[]);return React.createElement(React.Fragment,null,React.createElement(\"div\",null,React.createElement(\"div\",null,React.createElement(\"section\",{class:\"section\",style:{paddingTop:'24px',marginTop:'-6rem'}},React.createElement(\"div\",{class:\"container\"},React.createElement(\"button\",{id:\"speechQuestionTitle\",style:{display:'none'},onClick:function onClick(){return startSpeech();}},\"Speak\"),React.createElement(\"div\",null,React.createElement(\"div\",{id:\"engine_container-9__1Cs0M\",style:{display:isVoiceActive?'block':'none'}}),isShouldExplain&&React.createElement(\"div\",{class:\"engine_wrap__3VDEv\"},React.createElement(\"button\",{class:\"engine_button__2ohdd\",onClick:function onClick(){return onExplainClick();}},explainLabel))),React.createElement(\"div\",{style:{float:'right'}},React.createElement(\"span\",null,React.createElement(\"b\",null,\"Time left\"),\"\\xA0\\xA0\"),React.createElement(Timer,{seconds:timeRemaining})),React.createElement(\"div\",null,React.createElement(\"div\",{style:{lineHeight:'28px'}},React.createElement(\"b\",null,\"Live coding question:\"),\"\\xA0\\xA0\",questionTitle,\"\\xA0\\xA0\",questionDescription,React.createElement(\"br\",null),React.createElement(\"span\",null),React.createElement(\"br\",null),React.createElement(\"span\",{style:{color:'#05976e'}},\"*Use \",lang,\" to write your code.\"),React.createElement(\"span\",{style:{color:'#666',fontSize:'0.8rem'}},\"(Please allow \",React.createElement(\"b\",null,\"camera access\"),\". Your video is kept private.)\")),React.createElement(\"br\",null),React.createElement(\"div\",{id:\"container\",class:\"engine_editor-container__2uqGs\",style:{width:'100%',height:'350px'}},React.createElement(Editor,{defaultLanguage:lang,defaultValue:defaultCode,onChange:handleEditorChange})),showOutput&&React.createElement(\"div\",{id:\"outputContainer\",class:\"engine_editor-container__2uqGs\",style:{width:'100%',height:'129px'}},React.createElement(\"textarea\",_defineProperty({disabled:true,value:\"output\",width:\"300px\",height:\"400px\",className:\"engine_engine_output__dBs6o__2T5H9\"},\"value\",output))),React.createElement(\"div\",{class:\"buttons mb-20\",style:{fontSize:'2rem',display:'block',margin:'0 auto',left:'0',right:'0',textAlign:'center',zIndex:'9'}},React.createElement(\"div\",{className:\"buttons mb-20\",style:{marginTop:'36px'}},React.createElement(\"span\",{className:\"button is-primary mr-4\",onClick:function onClick(){run();}},\"Save & Run\"),!isLastQuestion?React.createElement(\"span\",{className:\"button is-primary mr-4 engine_right-btn-span__3aObT\",onClick:function onClick(){submit();}},\"Submit & Load Next >\"):React.createElement(React.Fragment,null,React.createElement(\"span\",{className:\"button is-primary mr-4 engine_right-btn-span__3aObT\",onClick:function onClick(){submit();}},\"Submit & Finish\"),React.createElement(\"div\",{class:\"engine_bubble__3jzVX engine_bubble-left__2mlj5\"},\"This is the final question of your assessment.\")))))))),isLoading&&React.createElement(\"div\",{class:\"profile_spinner-container__3FkTD\"},React.createElement(\"span\",{class:\"profile_spinner__1u7yJ\"})),React.createElement(\"div\",{class:\"navbar-side is-hidden is-fixed is-top-0 is-left-0 has-background-blur\",style:{zIndex:'50',width:'100%',height:'100%'}},React.createElement(\"div\",{class:\"is-absolute\",style:{zIndex:'-1;'}}),React.createElement(\"div\",{class:\"container is-relative\"},React.createElement(\"a\",{class:\"navbar-close is-absolute is-right-0 mt-6 mr-6\",href:\"#\"},React.createElement(\"img\",{src:\"acros-assets/icons/mobile-decline.svg\",alt:\"\"}))),React.createElement(\"aside\",{class:\"py-6 px-6 pb-8 has-background-white is-flex is-flex-direction-column is-justify-content-space-between\",style:{height:'100%',width:'288px',overflowY:'auto'}},React.createElement(\"div\",null,React.createElement(\"a\",{class:\"navbar-item title is-size-4 has-text-dark pl-4 mb-5\",href:\"#\"},React.createElement(\"img\",{src:\"acros-assets/logo/logo.png\",width:\"auto\",style:{maxHeight:'initial',width:'70px'},alt:\"\"}))),React.createElement(\"div\",null,React.createElement(\"div\",{class:\"buttons mb-8\"},React.createElement(\"a\",{class:\"button is-dark is-outlined is-fullwidth mb-4\",href:\"#\"},\"Log In\"),React.createElement(\"a\",{class:\"button is-primary is-fullwidth\",href:\"#\"},\"Sign up\")),React.createElement(\"small\",{class:\"has-text-grey-darker ml-6\"},\"2021 \\xA9 Shuffle\"))))),React.createElement(\"section\",{class:\"section py-16\",id:\"cvLive\",style:{paddingTop:'0px !important'}},React.createElement(\"div\",{class:\"container\"},React.createElement(\"div\",{class:\"columns is-align-items-center mb-0\"},React.createElement(\"div\",{class:\"column mb-16 mb-0-tablet\",style:{marginTop:'76px'}},React.createElement(\"h2\",{class:\"title mb-6 has-mw-lg\",style:{fontSize:'2.2rem'}}),React.createElement(\"p\",{class:\"subtitle has-mw-md mb-12\"},React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"br\",null))),React.createElement(\"div\",{class:\"column\"})))));};export default AssessmentEngine;","map":{"version":3,"sources":["/Users/sampath/Documents/code/me/stint-web/src/components/assessment/engine/index.jsx"],"names":["React","useState","useEffect","useRef","Editor","useMonaco","useSpeechSynthesis","CONSTANTS","Timer","AssessmentEngine","LANG_ID_JAVA","sessionStorage","getItem","speechQuestionTitle","monaco","input","setInput","lang","setLang","questionTitle","setQuestionTitle","questionDescription","setQuestionDescription","langId","setLangId","questionId","setQuestionId","userInput","setUserInput","output","setOutput","defaultCode","setDefaultCode","showOutput","setShowOutput","timeRemaining","setTimeRemaining","lastOutput","setLastOutput","resultCriteria","setResultCriteria","syntacticalErrors","setSyntacticalErrors","attemptedQuestionId","setAttemptedQuestionId","isLastQuestion","setIsLastQuestion","isLoading","setIsLoading","isVoiceActive","setIsVoiceActive","isShouldExplain","setIsShouldExplain","explainLabel","setExplainLabel","prompt_run_error","prompt_explain","prompt_run_success","prompt_code","onSpeechEnd","console","log","onEnd","speak","voices","handleEditorChange","value","event","localStorage","setItem","invokeAPI","fetch","method","headers","accept","body","JSON","stringify","source_code","stdin","language_id","response","json","jsonResponse","ok","message","status","Error","jsonGetSolution","description","stderr","compile_output","token","url","getSolution","stdout","atob","time","memory","sayExecutionSuccess","error","compilation_error","errCount","sayCompilationFailure","run","e","submit","rawResponse","ENDPOINT","DIRECTUSAUTH","then","res","r","data","access_token","accessToken","createSessionRecording","recording","parse","events","replaceAll","POSTSESSIONRECORDING","parseInt","captureResults","solutionCorrectnessValue","timeTakenMin","numSyntacticalErrors","minRem","document","getElementById","innerHTML","split","secRem","questionTimeLimitSecs","secondsRemaining","indexOf","createEvaluation","loadNextQuestion","progressDifficultyLevel","currentDifficultyLevel","nextDifficultyLevel","window","location","href","reload","metric","POSTEVALUATION","getTimeLimitInMilliSecs","timeStr","replace","timeInMins","timeInMilliSecs","checkIsLastQuestion","timeLimit","timeLimitInMilliSecs","timeLimitInSecs","timeLimitInMin","activeQuestionDuration","totalDuration","startQuestionTimer","setTimeout","getQuestion","skillId","competencyId","difficultyLevel","GETQUESTION","questionIndex","question","length","id","title","codeSnippet","code_snippet","time_limit","questionSpeechFileId","speech","result_criteria","promptQuestion","getQuestionToken","startSessionRecord","rrweb","save","record","emit","push","setInterval","audioTune","Audio","GETSPEECHFILE","load","play","promptExplain","promptToCode","onExplainClick","startSpeech","text","voice","rate","pitch","startVoiceBot","SW9","SiriWave","style","container","autostart","showVideo","paddingTop","marginTop","display","float","lineHeight","color","fontSize","width","height","margin","left","right","textAlign","zIndex","overflowY","maxHeight"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport {useState, useEffect, useRef} from \"react\";\r\nimport Editor, { useMonaco } from \"@monaco-editor/react\";\r\nimport { useSpeechSynthesis } from 'react-speech-kit';\r\nimport CONSTANTS from \"../../../constants\";\r\nimport \"./engine.module.css\";\r\nimport Timer from '../../core/timer';\r\n\r\nconst AssessmentEngine = ({}) => {\r\n\r\nconst LANG_ID_JAVA = sessionStorage.getItem('editorLangId');\r\nconst speechQuestionTitle = useRef(null);\r\n\r\nconst monaco = useMonaco();\r\nconst [input, setInput] = useState({});\r\nconst [lang, setLang] = useState(\"\");\r\nconst [questionTitle, setQuestionTitle] = useState(\"\");\r\nconst [questionDescription, setQuestionDescription] = useState(\"\");\r\nconst [langId, setLangId] = useState(0);\r\nconst [questionId, setQuestionId] = useState(0);\r\nconst [userInput, setUserInput] = useState({});\r\nconst [output, setOutput] = useState(\"Running...\");\r\nconst [defaultCode, setDefaultCode] = useState(sessionStorage.getItem('defaultCode'));\r\nconst [showOutput, setShowOutput] = useState(false);\r\nconst [timeRemaining, setTimeRemaining] = useState(0);\r\nconst [lastOutput, setLastOutput] = useState(\"\");\r\nconst [resultCriteria, setResultCriteria] = useState(\"\");\r\nconst [syntacticalErrors, setSyntacticalErrors] = useState(0);\r\nconst [attemptedQuestionId, setAttemptedQuestionId] = useState(0);\r\nconst [isLastQuestion, setIsLastQuestion] = useState(false);\r\nconst [isLoading, setIsLoading] = useState(false);\r\nconst [isVoiceActive, setIsVoiceActive] = useState(false);\r\nconst [isShouldExplain, setIsShouldExplain] = useState(false);\r\nconst [explainLabel, setExplainLabel] = useState(\"Explain your approach\");\r\n\r\nconst prompt_run_error = '0d79dc22-de64-4f90-86da-3cd5a297fe5c';\r\nconst prompt_explain = '5ce4a72e-9736-46f2-9ed3-1e25c338ac78';\r\nconst prompt_run_success = 'a8e8fb65-f298-4012-9b42-d4b165b8b197';\r\nconst prompt_code = 'a27e8bea-185a-4598-ae9d-9ce1412a2bcd';\r\n\r\nconst onSpeechEnd = () => {\r\n   console.log('on end');\r\n  setIsVoiceActive(false);\r\n};\r\n\r\nconst { speak, voices } = useSpeechSynthesis({onEnd: onSpeechEnd,});\r\n\r\nconst handleEditorChange = (value, event) => {\r\n    setInput(value);\r\n    localStorage.setItem('input', value);\r\n    setShowOutput(false);\r\n};\r\n\r\nconst invokeAPI = async () => {\r\n    setOutput('Creating Submission ...');\r\n    const response = await fetch(\r\n      \"https://judge0-ce.p.rapidapi.com/submissions\",\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"x-rapidapi-host\": \"judge0-ce.p.rapidapi.com\",\r\n          \"x-rapidapi-key\": \"a1504d0aebmsha2c15d90ecffa8dp117081jsn36e10aaf0ea7\", // Get yours for free at https://rapidapi.com/judge0-official/api/judge0-ce/\r\n          \"content-type\": \"application/json\",\r\n          accept: \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          source_code: input,\r\n          stdin: null,\r\n          language_id: langId,\r\n        }),\r\n      }\r\n    );\r\n    setOutput(\"Submission Created ...\\n\");\r\n    const jsonResponse = await response.json();\r\n    if (!response.ok) {\r\n                const message = `An error has occured: ${response.status}`;\r\n                throw new Error(message);\r\n              }\r\n\r\n    let jsonGetSolution = {\r\n      status: { description: \"Queue\" },\r\n      stderr: null,\r\n      compile_output: null,\r\n    };\r\n\r\n    while (\r\n      jsonGetSolution.status.description !== \"Accepted\" &&\r\n      jsonGetSolution.stderr == null &&\r\n      jsonGetSolution.compile_output == null\r\n    ) {\r\n      setOutput(`Creating Submission ... \\nSubmission Created ...\\nChecking Submission Status\\nstatus : ${jsonGetSolution.status.description}`);\r\n      if (jsonResponse.token) {\r\n        let url = `https://judge0-ce.p.rapidapi.com/submissions/${jsonResponse.token}?base64_encoded=true`;\r\n\r\n        const getSolution = await fetch(url, {\r\n          method: \"GET\",\r\n          headers: {\r\n            \"x-rapidapi-host\": \"judge0-ce.p.rapidapi.com\",\r\n            \"x-rapidapi-key\": \"a1504d0aebmsha2c15d90ecffa8dp117081jsn36e10aaf0ea7\", // Get yours for free at https://rapidapi.com/judge0-official/api/judge0-ce/\r\n            \"content-type\": \"application/json\",\r\n          },\r\n        });\r\n\r\n        jsonGetSolution = await getSolution.json();\r\n      }\r\n    }\r\n    if (jsonGetSolution.stdout) {\r\n      const output = atob(jsonGetSolution.stdout);\r\n      console.log('--output--', output);\r\n      setLastOutput(output);\r\n      setOutput(`Results :\\n${output}\\nExecution Time : ${jsonGetSolution.time} Secs\\nMemory used : ${jsonGetSolution.memory} bytes`);\r\n      sayExecutionSuccess();\r\n    } else if (jsonGetSolution.stderr) {\r\n      const error = atob(jsonGetSolution.stderr);\r\n      setOutput(`\\n Error :${error}`);\r\n    } else {\r\n      const compilation_error = atob(jsonGetSolution.compile_output);\r\n      let errCount = syntacticalErrors + 1;\r\n      setSyntacticalErrors(errCount);\r\n      console.log('syntacticalError', syntacticalErrors);\r\n      setOutput(`\\n Error :${compilation_error}`);\r\n      sayCompilationFailure();\r\n    }\r\n}\r\n\r\nconst run = (e) => {\r\n  setShowOutput(true);\r\n\r\n  /* window.addEventListener('unhandledrejection', event => { console.log('E: ',event); });\r\n  onunhandledrejection = event => {\r\n    alert('There was an error submitting your code. Pls check your syntax & try again.')\r\n    console.log('invoke API '); //window.location.reload();\r\n  }; */\r\n\r\n  invokeAPI();\r\n}\r\n\r\nconst submit = (e) => {\r\n  setIsLoading(true);\r\n  const rawResponse = fetch(CONSTANTS.ENDPOINT.DIRECTUSAUTH, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: JSON.stringify({\r\n         \"email\": \"stint.assess@gmail.com\",\r\n         \"password\": \"dstintapp1\"\r\n       })}).then((res)=>{\r\n         var res = res.json();\r\n         res.then(function(r) {\r\n           console.log('Data: ', r.data);\r\n           console.log('AccessToken: ', r.data.access_token);\r\n               var accessToken = r.data.access_token;\r\n               createSessionRecording(accessToken);\r\n         });\r\n       });\r\n}\r\n\r\nconst createSessionRecording = (accessToken) => {\r\n       let recording = JSON.stringify(JSON.parse(localStorage.getItem('recording')).events);\r\n       recording = recording.replaceAll(\"'\", \"&quot\");\r\n       const rawResponse = fetch(CONSTANTS.ENDPOINT.POSTSESSIONRECORDING, {\r\n           method: 'POST',\r\n           headers: {\r\n             'Accept': 'application/json',\r\n             'Content-Type': 'application/json'\r\n           },\r\n           body: JSON.stringify({\r\n          \"questionId\": questionId,\r\n          \"sessionId\": parseInt(sessionStorage.getItem('assessment_session_id'),10),\r\n          \"events\":recording\r\n        })}).then((res)=>{\r\n          var res = res.json();\r\n          res.then(function(r) {\r\n            console.log('session recording submitted');\r\n            captureResults(accessToken);\r\n          });\r\n       });\r\n    }\r\n\r\nconst captureResults = (accessToken) => {\r\n    let solutionCorrectnessValue = 0;\r\n    let timeTakenMin = 0;\r\n    const numSyntacticalErrors = 0;\r\n\r\n    let minRem = document.getElementById('timeRem').innerHTML.replaceAll(' ','').split(':')[1];\r\n    let secRem = document.getElementById('timeRem').innerHTML.replaceAll(' ','').replaceAll('s','').split(':')[2];\r\n\r\n    const questionTimeLimitSecs = timeRemaining;\r\n    const secondsRemaining = parseInt(minRem, 10) * 60 + parseInt(secRem, 10);\r\n    console.log('--timeLimit--', questionTimeLimitSecs);\r\n    console.log('--secondsElapsed--', secondsRemaining);\r\n    timeTakenMin = (questionTimeLimitSecs - secondsRemaining)/60;\r\n    console.log('--timeTakenMin--', timeTakenMin);\r\n\r\n    if(lastOutput != \"\" && lastOutput.indexOf(resultCriteria) >= 0) {\r\n      solutionCorrectnessValue = 100;\r\n    }\r\n    createEvaluation(accessToken, \"solution_correctness\", solutionCorrectnessValue);\r\n    createEvaluation(accessToken, \"time_taken_mins\", timeTakenMin);\r\n    createEvaluation(accessToken, \"num_syntactical_errors\", syntacticalErrors);\r\n    sessionStorage.setItem(\"attemptedQuestionIds\", sessionStorage.getItem('attemptedQuestionIds')+attemptedQuestionId+',');\r\n    loadNextQuestion(solutionCorrectnessValue, timeTakenMin, syntacticalErrors);\r\n}\r\n\r\nconst loadNextQuestion = (solutionCorrectnessValue, timeTakenMin, syntacticalErrors) => {\r\n    var progressDifficultyLevel = false;\r\n    var currentDifficultyLevel = sessionStorage.getItem(\"difficultyLevel\");\r\n    var nextDifficultyLevel = currentDifficultyLevel;\r\n\r\n    //completed in half the time\r\n    if (timeTakenMin*60  < timeRemaining/2\r\n       && syntacticalErrors < 30) {\r\n       progressDifficultyLevel = true;\r\n    }\r\n    if (progressDifficultyLevel) {\r\n      if (currentDifficultyLevel == 'Beginner') {\r\n        nextDifficultyLevel = \"Intermediate\";\r\n      } else if (currentDifficultyLevel == 'Intermediate') {\r\n        nextDifficultyLevel = \"Advanced\";\r\n      }\r\n      sessionStorage.setItem(\"difficultyLevel\", nextDifficultyLevel);\r\n      console.log('Difficulty level progressed!');\r\n    }\r\n    if (isLastQuestion) {\r\n      window.location.href = '/assessment/done';\r\n    } else {\r\n      window.location.reload();\r\n    }\r\n}\r\n\r\nconst createEvaluation = (accessToken, metric, value) => {\r\n  const rawResponse = fetch(CONSTANTS.ENDPOINT.POSTEVALUATION + accessToken, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Accept': 'application/json',\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n     \"question_id\": questionId,\r\n     \"assessment_session_id\": parseInt(sessionStorage.getItem('assessment_session_id'),10),\r\n     \"metric\": metric,\r\n     \"value\": value\r\n   })}).then((res)=>{\r\n     var res = res.json();\r\n     res.then(function(r) {\r\n       console.log('Data: ', r.data);\r\n     });\r\n  });\r\n}\r\n\r\nconst getTimeLimitInMilliSecs = (timeStr) => {\r\n  timeStr = timeStr.replace(' min','');\r\n  var timeInMins = parseInt(timeStr, 10);\r\n  var timeInMilliSecs = timeInMins * 60 * 1000;\r\n  return timeInMilliSecs;\r\n}\r\n\r\nconst checkIsLastQuestion = (timeLimit) => {\r\n  var timeLimitInMilliSecs = getTimeLimitInMilliSecs(timeLimit);\r\n  var timeLimitInSecs = timeLimitInMilliSecs/1000;\r\n  var timeLimitInMin = timeLimitInSecs/60;\r\n  var activeQuestionDuration = timeLimitInMin;\r\n  var totalDuration = parseInt(sessionStorage.getItem('totalDuration'), 10);\r\n  if (sessionStorage.getItem('activeQuestionDuration') != null\r\n      && sessionStorage.getItem('activeQuestionDuration') != \"\") {\r\n      activeQuestionDuration = activeQuestionDuration + parseInt(sessionStorage.getItem('activeQuestionDuration'), 10);\r\n  }\r\n  sessionStorage.setItem('activeQuestionDuration', activeQuestionDuration);\r\n  // make current question as last question if time remaining < 10 min\r\n  if (totalDuration - activeQuestionDuration < 10) {\r\n    setIsLastQuestion(true);\r\n  }\r\n}\r\n\r\nconst startQuestionTimer = (timeLimit) => {\r\n  var timeLimitInMilliSecs = getTimeLimitInMilliSecs(timeLimit);\r\n  var timeLimitInSecs = timeLimitInMilliSecs/1000;\r\n  console.log('::timer::')\r\n  setTimeRemaining(timeLimitInSecs);\r\n  console.log('timeInMilliSecs: ', timeLimitInMilliSecs);\r\n  setTimeout(function() {\r\n    console.log('load next question');\r\n  }, timeLimitInMilliSecs);\r\n}\r\n\r\nconst getQuestion = (accessToken, skillId, competencyId, difficultyLevel) => {\r\n       console.log('calling getQuestion...');\r\n       const rawResponse = fetch(CONSTANTS.ENDPOINT.GETQUESTION + accessToken + '&filter={ \"difficulty_level\": { \"_eq\": \"'+difficultyLevel+'\" }, \"skill_id\": { \"_eq\": '+skillId+' }, \"competency\": { \"_eq\": '+competencyId+' }}').then((res)=>{\r\n        var res = res.json();\r\n          res.then(function(r) {\r\n            var questionIndex = 0;\r\n            var question = r.data;\r\n            console.log('--question[questionIndex].id--', questionIndex);\r\n            console.log('--question[]--', question.length);\r\n            while(sessionStorage.getItem(\"attemptedQuestionIds\") == null\r\n              || (sessionStorage.getItem(\"attemptedQuestionIds\") != \"\"\r\n              && question.length > questionIndex\r\n              && sessionStorage.getItem(\"attemptedQuestionIds\").indexOf(question[questionIndex].id+',')==-1)) {\r\n                console.log('--questionIndex', questionIndex);\r\n                var title = question[questionIndex].title;\r\n                var description = question[questionIndex].description;\r\n                var codeSnippet = question[questionIndex].code_snippet;\r\n                var timeLimit = question[questionIndex].time_limit;\r\n                var questionSpeechFileId = question[questionIndex].speech;\r\n                setQuestionId(question[questionIndex].id);\r\n                console.log('codeSnippet: ', codeSnippet);\r\n                console.log('timeLimit', timeLimit);\r\n                startQuestionTimer(timeLimit);\r\n                checkIsLastQuestion(timeLimit);\r\n                setInput(codeSnippet);\r\n                setQuestionTitle(title);\r\n                setQuestionDescription(description);\r\n                setResultCriteria(question[questionIndex].result_criteria);\r\n                setAttemptedQuestionId(question[questionIndex].id);\r\n                promptQuestion(accessToken, questionSpeechFileId);\r\n                questionIndex++;\r\n                break;\r\n            }\r\n          });\r\n        });\r\n    }\r\n\r\nconst getQuestionToken = () => {\r\n  const rawResponse = fetch(CONSTANTS.ENDPOINT.DIRECTUSAUTH, {\r\n           method: 'POST',\r\n           headers: {\r\n             'Accept': 'application/json',\r\n             'Content-Type': 'application/json'\r\n           },\r\n           body: JSON.stringify({\r\n          \"email\": \"stint.assess@gmail.com\",\r\n          \"password\": \"dstintapp1\"\r\n        })}).then((res)=>{\r\n          var res = res.json();\r\n          res.then(function(r) {\r\n            console.log('Data: ', r.data);\r\n            console.log('AccessToken1: ', r.data.access_token);\r\n                var accessToken = r.data.access_token;\r\n                var difficultyLevel = sessionStorage.getItem(\"difficultyLevel\"); //read from session storage\r\n                var skillId = sessionStorage.getItem(\"primarySkill\"); //read from session storage\r\n                var competencyId = sessionStorage.getItem(\"competencyId\"); //read from session storage\r\n                getQuestion(accessToken, skillId, competencyId, difficultyLevel);\r\n\r\n          });\r\n        });\r\n}\r\nvar events = [];\r\nconst startSessionRecord = () => {\r\n\r\n  if(typeof window.rrweb != \"undefined\") {\r\n    window.rrweb.record({\r\n        emit(event) {\r\n          // push event into the events array\r\n          events.push(event);\r\n        },\r\n      });\r\n      function save() {\r\n        const body = JSON.stringify({ events });\r\n        localStorage.setItem('recording', body);\r\n        console.log('--events--', body);\r\n        /* new window.rrwebPlayer({\r\n          target: document.getElementById('container'), // customizable root element\r\n          props: {\r\n            events\r\n          },\r\n        }); */\r\n      }\r\n      setInterval(save, 15 * 1000);\r\n  }\r\n}\r\n\r\nconst promptQuestion = (accessToken, questionSpeechFileId) => {\r\n  const audioTune = new Audio(CONSTANTS.ENDPOINT.GETSPEECHFILE.replace('<asset-id>',questionSpeechFileId) + accessToken);\r\n  audioTune.load();audioTune.play();\r\n  setTimeout(function(){setIsVoiceActive(true);},500);\r\n  setTimeout(function(){setIsVoiceActive(false);promptExplain(accessToken);\r\n    setTimeout(function(){ setIsShouldExplain(true); },10000);\r\n  },11000);\r\n}\r\n\r\nconst promptExplain = (accessToken) => {\r\n  const audioTune = new Audio(CONSTANTS.ENDPOINT.GETSPEECHFILE.replace('<asset-id>',prompt_explain) + accessToken);\r\n  audioTune.load();audioTune.play();\r\n  setTimeout(function(){setIsVoiceActive(true);},1500);\r\n  setTimeout(function(){setIsVoiceActive(false);},14000);\r\n}\r\n\r\nconst promptToCode = () => {\r\n  const rawResponse = fetch(CONSTANTS.ENDPOINT.DIRECTUSAUTH, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Accept': 'application/json',\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n     \"email\": \"stint.assess@gmail.com\",\r\n     \"password\": \"dstintapp1\"\r\n   })}).then((res)=>{\r\n     var res = res.json();\r\n     res.then(function(r) {\r\n         var accessToken = r.data.access_token;\r\n         const audioTune = new Audio(CONSTANTS.ENDPOINT.GETSPEECHFILE.replace('<asset-id>',prompt_code) + accessToken);\r\n         audioTune.load();audioTune.play();\r\n         setTimeout(function(){setIsVoiceActive(true);},1500);\r\n         setTimeout(function(){setIsVoiceActive(false);},6000);\r\n     });\r\n   });\r\n}\r\n\r\nconst sayExecutionSuccess = () => {\r\n  //speak({ text: \"Great! Your code executed successfully.\", voice: voices[0], rate: 1, pitch: 1.7 });\r\n  const rawResponse = fetch(CONSTANTS.ENDPOINT.DIRECTUSAUTH, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Accept': 'application/json',\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n     \"email\": \"stint.assess@gmail.com\",\r\n     \"password\": \"dstintapp1\"\r\n   })}).then((res)=>{\r\n     var res = res.json();\r\n     res.then(function(r) {\r\n         var accessToken = r.data.access_token;\r\n         const audioTune = new Audio(CONSTANTS.ENDPOINT.GETSPEECHFILE.replace('<asset-id>',prompt_run_success) + accessToken);\r\n           audioTune.load();audioTune.play();\r\n           setTimeout(function(){setIsVoiceActive(true);},700);\r\n           setTimeout(function(){setIsVoiceActive(false);},4000);\r\n     });\r\n   });\r\n}\r\n\r\nconst sayCompilationFailure = () => {\r\n  //speak({ text: \"There-are some errors. Please-check your code and try again.\", voice: voices[0], rate: 1.1, pitch: 1.9 });\r\n  const rawResponse = fetch(CONSTANTS.ENDPOINT.DIRECTUSAUTH, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Accept': 'application/json',\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n       \"email\": \"stint.assess@gmail.com\",\r\n       \"password\": \"dstintapp1\"\r\n     })}).then((res)=>{\r\n       var res = res.json();\r\n       res.then(function(r) {\r\n           var accessToken = r.data.access_token;\r\n           const audioTune = new Audio(CONSTANTS.ENDPOINT.GETSPEECHFILE.replace('<asset-id>',prompt_run_error) + accessToken);\r\n             audioTune.load();audioTune.play();\r\n             setTimeout(function(){setIsVoiceActive(true);},700);\r\n             setTimeout(function(){setIsVoiceActive(false);},4000);\r\n       });\r\n     });\r\n}\r\n\r\nconst onExplainClick = () => {\r\n  if (explainLabel == 'Explain your approach' || explainLabel == 'Explain again') {\r\n    setExplainLabel(\"Listening... click to end recording\");\r\n  } else {\r\n    setExplainLabel(\"Explain again\");\r\n    promptToCode();\r\n  }\r\n}\r\n\r\nconst startSpeech = ()=> {\r\n  speak({ text: questionTitle, voice: voices[0], rate: 1, pitch: 1.7 });\r\n  setIsVoiceActive(true);\r\n\r\n  setTimeout(function() {\r\n      speak({ text: \"Use \"+lang+\" to write your code\", voice: voices[0], rate: 1, pitch: 1.7 });\r\n      setIsVoiceActive(true);\r\n      /* setTimeout(function() {\r\n            speak({ text: \"You can think through an approach and once you're ready you can explain. This will be recorded and used during evaluation.\", voice: voices[0], rate: 1, pitch: 1.7 });\r\n            setIsVoiceActive(true);\r\n            setTimeout(function() {\r\n                        speak({ text: \"Please go ahead once you're-ready.\", voice: voices[0], rate: 1, pitch: 1.7 });\r\n                        setIsVoiceActive(true);\r\n                    }, 1500);\r\n        }, 1500); */\r\n  }, 1500);\r\n}\r\n\r\nconst startVoiceBot = () => {\r\n\r\n    const SW9 = new window.SiriWave({\r\n    style: \"ios9\",\r\n    container: document.getElementById(\"engine_container-9__1Cs0M\"),\r\n    autostart: true,\r\n    });\r\n\r\n    //ToDo: Uncomment to use speech synthesis API than FreeTTS\r\n    //setTimeout(\"document.getElementById('speechQuestionTitle').click()\",2000);\r\n\r\n    //https://freetts.com/Home/PlayAudio?Language=en-IN&Voice=en-IN-Standard-C&TextMessage=Find%20the%20frequency%20of%20each%20number%20in%20the%20given%20arraylist.%20%3Cbreak%20time%3D%221s%22%20%2F%3E%20Print%20output%20to%20console%20in%20the%20format%20given.%20%3Cbreak%20time%3D%221.5s%22%20%2F%3EUse%20Java%20to%20write%20your%20code.&type=0\r\n\r\n    /* const rawResponse = fetch('https://freetts.com/Home/PlayAudio?Language=en-IN&Voice=en-IN-Standard-C&TextMessage=Find%20the%20frequency%20of%20each%20number%20in%20the%20given%20arraylist.%20%3Cbreak%20time%3D%221s%22%20%2F%3E%20Print%20output%20to%20console%20in%20the%20format%20given.%20%3Cbreak%20time%3D%221.5s%22%20%2F%3EUse%20Java%20to%20write%20your%20code.&type=0',\r\n    headers: {\r\n        'mode':'cors'\r\n      }).then((res)=>{\r\n      var res = res.json();\r\n        res.then(function(r) {\r\n          var speechURL = r.id;\r\n          console.log('Speech Response: ', r);\r\n          console.log('Speech Data: ', r.data);\r\n          console.log('Speech URL: ', speechURL);\r\n          //setSpeechURL(speechURL);\r\n        });\r\n      }); */\r\n}\r\n\r\nuseEffect(() => {\r\nwindow.showVideo = true;\r\n\r\nsetLang(sessionStorage.getItem('editorLangName'));\r\nsetLangId(LANG_ID_JAVA);\r\nlocalStorage.setItem('language_Id',LANG_ID_JAVA)\r\nif (localStorage.getItem('input') != null) {\r\nconsole.log('localStorage.getItem(input): ', localStorage.getItem('input'));\r\n  setDefaultCode(localStorage.getItem('input'));\r\n  setInput(localStorage.getItem('input'));\r\n}\r\n\r\n\r\ngetQuestionToken();\r\n\r\nstartSessionRecord();\r\n\r\nstartVoiceBot();\r\n\r\n\r\n//setOutput(\"Click the 'Save & Run' button to view your program's output.\");\r\n    if (monaco) {\r\n      console.log(\"here is the monaco instance:\", monaco);\r\n    }\r\n  }, []);\r\n\r\n\r\n\r\n\r\n\r\n\r\nreturn (\r\n  <React.Fragment>\r\n\r\n    <div>\r\n      <div>\r\n        <section class=\"section\" style={{paddingTop: '24px', marginTop: '-6rem'}}>\r\n\r\n          <div class=\"container\">\r\n          <button id=\"speechQuestionTitle\" style={{display: 'none'}} onClick={() => startSpeech()}>Speak</button>\r\n            <div>\r\n              <div id=\"engine_container-9__1Cs0M\" style={{display: isVoiceActive ? 'block' : 'none'}}></div>\r\n              {isShouldExplain && <div class=\"engine_wrap__3VDEv\">\r\n                <button class=\"engine_button__2ohdd\" onClick={()=>onExplainClick()}>{explainLabel}</button>\r\n              </div>}\r\n            </div>\r\n            <div style={{float: 'right'}}>\r\n              <span><b>Time left</b>&nbsp;&nbsp;</span><Timer seconds={timeRemaining} />\r\n            </div>\r\n            <div>\r\n              <div style={{lineHeight: '28px'}}><b>Live coding question:</b>&nbsp;&nbsp;{questionTitle}&nbsp;&nbsp;{questionDescription}<br/><span></span><br/><span style={{color: '#05976e'}}>*Use {lang} to write your code.</span>\r\n                <span style={{color:'#666',fontSize:'0.8rem'}}>(Please allow <b>camera access</b>. Your video is kept private.)</span>\r\n              </div>\r\n              <br/>\r\n              <div id=\"container\" class=\"engine_editor-container__2uqGs\" style={{width: '100%',height: '350px'}}>\r\n                <Editor\r\n                      defaultLanguage={lang}\r\n                      defaultValue={defaultCode}\r\n                      onChange={handleEditorChange}\r\n                    />\r\n              </div>\r\n              {showOutput && <div id=\"outputContainer\" class=\"engine_editor-container__2uqGs\" style={{width: '100%',height: '129px'}}>\r\n                <textarea disabled value=\"output\" width=\"300px\" height=\"400px\" className=\"engine_engine_output__dBs6o__2T5H9\" value={output}/>\r\n              </div>}\r\n\r\n\r\n\r\n              <div class=\"buttons mb-20\" style={{fontSize: '2rem',display: 'block',margin: '0 auto',left: '0',right: '0',textAlign: 'center', zIndex: '9'}}>\r\n                <div className=\"buttons mb-20\" style={{marginTop: '36px'}}>\r\n                  <span className=\"button is-primary mr-4\" onClick={()=>{run()}}>Save & Run</span>\r\n                  {\r\n                    !isLastQuestion ? <span className=\"button is-primary mr-4 engine_right-btn-span__3aObT\" onClick={()=>{submit()}}>Submit & Load Next &gt;</span>\r\n                    : <><span className=\"button is-primary mr-4 engine_right-btn-span__3aObT\" onClick={()=>{submit()}}>Submit & Finish</span>\r\n                    <div class=\"engine_bubble__3jzVX engine_bubble-left__2mlj5\">This is the final question of your assessment.</div></>\r\n                  }\r\n                </div>\r\n              </div>\r\n\r\n\r\n            </div>\r\n\r\n\r\n          </div>\r\n        </section>\r\n      </div>\r\n      { isLoading && <div class=\"profile_spinner-container__3FkTD\"><span class=\"profile_spinner__1u7yJ\"></span></div> }\r\n      <div class=\"navbar-side is-hidden is-fixed is-top-0 is-left-0 has-background-blur\" style={{zIndex: '50', width:'100%', height: '100%'}}>\r\n        <div class=\"is-absolute\" style={{zIndex: '-1;'}}></div>\r\n        <div class=\"container is-relative\">\r\n          <a class=\"navbar-close is-absolute is-right-0 mt-6 mr-6\" href=\"#\">\r\n            <img src=\"acros-assets/icons/mobile-decline.svg\" alt=\"\"/>\r\n          </a>\r\n        </div>\r\n        <aside class=\"py-6 px-6 pb-8 has-background-white is-flex is-flex-direction-column is-justify-content-space-between\" style={{height: '100%',width: '288px', overflowY: 'auto'}}>\r\n          <div>\r\n            <a class=\"navbar-item title is-size-4 has-text-dark pl-4 mb-5\" href=\"#\">\r\n              <img src=\"acros-assets/logo/logo.png\" width=\"auto\" style={{maxHeight: 'initial', width:'70px'}} alt=\"\"/>\r\n            </a>\r\n          </div>\r\n          <div>\r\n            <div class=\"buttons mb-8\"><a class=\"button is-dark is-outlined is-fullwidth mb-4\" href=\"#\">Log In</a><a class=\"button is-primary is-fullwidth\" href=\"#\">Sign up</a></div>\r\n            <small class=\"has-text-grey-darker ml-6\">2021  Shuffle</small>\r\n          </div>\r\n        </aside>\r\n      </div>\r\n    </div>\r\n\r\n    <section class=\"section py-16\" id=\"cvLive\" style={{paddingTop: '0px !important'}}>\r\n      <div class=\"container\">\r\n        <div class=\"columns is-align-items-center mb-0\">\r\n          <div class=\"column mb-16 mb-0-tablet\" style={{marginTop: '76px'}}>\r\n            <h2 class=\"title mb-6 has-mw-lg\" style={{fontSize: '2.2rem'}}></h2>\r\n            <p class=\"subtitle has-mw-md mb-12\"><br/><br/><br/><br/><br/></p>\r\n\r\n          </div>\r\n          <div class=\"column\">\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n\r\n\r\n\r\n\r\n  </React.Fragment>\r\n);\r\n}\r\nexport default AssessmentEngine;\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}